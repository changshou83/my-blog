# 变换矩阵

- MVP变换：Model-View-Projection

## 模型变换
### 二维变换

- 缩放
	- 缩放矩阵
		- `[sx 0]`
		- `[0 sy]`
- 错切
	- 水平错切矩阵
		- `[1 a]`
		- `[0 1]`
- 旋转
	- 旋转矩阵
		- `[cos -sin]`
		- `[sin cos]`
	- 旋转矩阵的逆矩阵等于转置矩阵
- 引入齐次坐标是为了不让平移这种操作特殊化(再加上一个常数矩阵),示例： 平移
	- 仿射变换
		- `[x'] = [a b] . [x] + [tx]`
		- `[y']   [c d]   [y]   [ty]`
	- 使用齐次坐标
		- `[x']   [a b tx]   [x]`
		- `[y'] = [c d ty] . [y]`
		- `[1 ]   [0 0 1 ]   [1]`

### 三维变换

- 使用齐次坐标进行变换
		- 3D的点：`(x, y, z, 1)^T`
		- 3D的向量：`(x, y, z, 0)^T`
		- `(x, y, z, w)(w!=0)为点(x/w,y/w,z/w)`
	- 缩放
		- `[sx  0  0 0]`
		- `[ 0 sy  0 0]`
		- `[ 0  0 sz 0]`
		- `[ 0  0  0 1]`
	- 旋转
		- 旋转公式
		- 四元数
	- 平移
		- `[1 0 0 tx]`
		- `[0 1 0 ty]`
		- `[0 0 1 tz]`
		- `[0 0 0  1]`

## 观测变换
### 视图变换

- 定义一个相机
	- 位置
	- 朝向
	- 自身的旋转(不同角度拍出来的视角不同)，也叫向上的角度
- 标准位置(这不就是人看屏幕的位置)
	- 位置：(0,0,0)
	- 朝向：-z
	- 向上的朝向：y
- 变换：将相机变换到标准位置(先旋转再平移)，场景中的物体也跟着变换，根据相对运动可知，最后结果不变

### 投影变换

- 正交
	- 假设将相机放到无限远处对物体进行投影
	- 如何变换
		- 先将物体平移到原点
			- 变换矩阵
				- `[1 0 0 -(r+l)/2]`
				- `[0 1 0 -(t+b)/2]`
				- `[0 0 1 -(n+f)/2]`
				- `[0 0 0 1]`
		- 将物体归一化成标准立方体(自己定义)
			- 变换矩阵
				- `[2/(r-l) 0 0 0]`
				- `[0 2/(t-b) 0 0]`
				- `[0 0 2/(n-f) 0]`
				- `[0 0 0 1]`
- 透视
	- 如何变换
		- 先将视椎体变换成长方体
			- 约束条件
				- 远近平面z轴位置不变
				- 远近平面中心不变
				- 向上角度不变
			- 变换矩阵(`Mpersp->ortho`)
				- `[n 0 0 0]`
				- `[0 n 0 0]`
				- `[0 0 n+f -nf]`
				- `[0 0 1 0]`
		- 然后进行正交变换
