import{_ as n,c as s,o as a,a as e}from"./app.635358c2.js";const b='{"title":"\u5206\u652F\u5207\u6362","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u95EE\u9898","slug":"\u95EE\u9898"},{"level":2,"title":"\u5B9A\u4E49","slug":"\u5B9A\u4E49"},{"level":2,"title":"\u601D\u8DEF","slug":"\u601D\u8DEF"},{"level":2,"title":"\u6539\u9020","slug":"\u6539\u9020"},{"level":3,"title":"effect","slug":"effect"},{"level":3,"title":"track","slug":"track"},{"level":3,"title":"cleanup","slug":"cleanup"},{"level":3,"title":"trigger","slug":"trigger"}],"relativePath":"vue/books/Vue.js Design/Main/02 \u54CD\u5E94\u7CFB\u7EDF/\u5B9E\u73B0/\u5206\u652F\u5207\u6362.md"}',t={},p=e(`<h1 id="\u5206\u652F\u5207\u6362" tabindex="-1">\u5206\u652F\u5207\u6362</h1><h2 id="\u95EE\u9898" tabindex="-1">\u95EE\u9898</h2><ul><li>\u53EF\u80FD\u4F1A\u4EA7\u751F\u9057\u7559\u7684effect</li></ul><h2 id="\u5B9A\u4E49" tabindex="-1">\u5B9A\u4E49</h2><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">function</span> <span class="token function">effectFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span>ok <span class="token operator">?</span> obj<span class="token punctuation">.</span>text <span class="token operator">:</span> <span class="token string">&#39;not&#39;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>\u4E0A\u9762\u8FD9\u6BB5\u4EE3\u7801\u4E2D\uFF0Cok\u4E3Atrue\u65F6\uFF0Cok,text\u90FD\u4F1A\u6536\u96C6\u8BE5effect\u3002\u4F46\u662F\u662F\u5F53ok\u4E3Afalse\u65F6\uFF0C\u65E0\u8BBAtext\u600E\u4E48\u53D8\uFF0C\u9875\u9762\u90FD\u4E0D\u4F1A\u53D1\u751F\u53D8\u5316\uFF0C\u4F46\u662Feffect\u4F9D\u65E7\u88AB\u6267\u884C\u3002\u6240\u4EE5\u7406\u60F3\u72B6\u6001\u4E0B\uFF0C\u5E94\u8BE5\u53EA\u6709ok\u6536\u96C6\u8FD9\u4E2Aeffect\u3002</p><h2 id="\u601D\u8DEF" tabindex="-1">\u601D\u8DEF</h2><ul><li>\u5728\u6BCF\u6B21\u526F\u4F5C\u7528\u51FD\u6570\u6267\u884C\u524D\uFF0C\u5148\u5C06\u5176\u4ECE\u6240\u5728\u7684\u4F9D\u8D56\u96C6\u5408\u4E2D\u5220\u9664\u3002\u5728\u6267\u884C\u540E\uFF0C\u5B83\u5C31\u53C8\u4F1A\u88AB\u91CD\u65B0\u6DFB\u52A0\u5165\u6B63\u786E\u7684\u4F9D\u8D56\u96C6\u5408\u3002</li></ul><h2 id="\u6539\u9020" tabindex="-1">\u6539\u9020</h2><h3 id="effect" tabindex="-1">effect</h3><ul><li>\u4F7F\u526F\u4F5C\u7528\u5177\u6709\u5176\u6240\u5728\u4F9D\u8D56\u96C6\u5408\u7684\u5217\u8868</li><li>\u5728\u6BCF\u6B21\u6267\u884C\u526F\u4F5C\u7528\u51FD\u6570\u4E4B\u524D\u5148\u6267\u884Ccleanup</li></ul><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">function</span> <span class="token function">effect</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">effectFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">cleanup</span><span class="token punctuation">(</span>effectFn<span class="token punctuation">)</span><span class="token punctuation">;</span>activeEffect <span class="token operator">=</span> effectFn<span class="token punctuation">;</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  effectFn<span class="token punctuation">.</span>deps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token function">effectFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="track" tabindex="-1">track</h3><ul><li>\u5728\u4F9D\u8D56\u6536\u96C6\u65F6\u5C06\u4F9D\u8D56\u5217\u8868\u586B\u5165\u526F\u4F5C\u7528\u51FD\u6570\u6240\u62E5\u6709\u7684\u4F9D\u8D56\u5217\u8868</li></ul><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">function</span> <span class="token function">track</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  activeEffect<span class="token punctuation">.</span>deps<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>deps<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="cleanup" tabindex="-1">cleanup</h3><ul><li>\u6839\u636E\u5217\u8868\u5C06\u526F\u4F5C\u7528\u51FD\u6570\u4ECE\u6240\u5728\u7684\u6240\u6709\u4F9D\u8D56\u96C6\u5408\u4E2D\u5220\u9664</li></ul><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token parameter">effectFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  effectFn<span class="token punctuation">.</span>deps<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">deps</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    deps<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>effectFn<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  effectFn<span class="token punctuation">.</span>deps<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token comment">// \u91CD\u7F6E deps</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="trigger" tabindex="-1">trigger</h3><ul><li>\u89E6\u53D1\u4F9D\u8D56\u65F6\uFF0C\u5148\u5220\u9664\u518D\u6DFB\u52A0\u7684\u64CD\u4F5C\uFF0C\u4F1A\u5BFC\u81F4effects(Set)\u65E0\u9650\u5FAA\u73AF\u4E0B\u53BB\uFF0C\u5C31\u50CF\u4F60\u4E22\u56DE\u65CB\u9556\u4E00\u6837\uFF0C\u5220\u9664=\u4E22\u51FA\u53BB\uFF0C\u6DFB\u52A0=\u53C8\u56DE\u6765\uFF0C\u8FD9\u6837\u4F60\u5C31\u4F1A\u65E0\u9650\u4E22\u4E0B\u53BB\u3002</li><li>\u5C06effects\u5305\u4E00\u5C42Set\uFF0C\u904D\u5386\u5916\u5C42set\u5C31\u4E0D\u4F1A\u6709\u8FD9\u4E2A</li></ul><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">function</span> <span class="token function">trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">const</span> effectsToRun <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>effects<span class="token punctuation">)</span>
  effectsToRun<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">effectFn</span> <span class="token operator">=&gt;</span> <span class="token function">effectFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// \u5220\u9664effects &amp;&amp; effects.forEach(effectFn =&gt; effectFn())</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>`,21),c=[p];function o(l,u,i,r,k,f){return a(),s("div",null,c)}var m=n(t,[["render",o]]);export{b as __pageData,m as default};
