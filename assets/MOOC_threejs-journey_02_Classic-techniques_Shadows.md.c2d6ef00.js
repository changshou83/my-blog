import{_ as n,c as s,o as a,a as p}from"./app.65ba7c0f.js";const m='{"title":"Shadows","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u5982\u4F55\u5F00\u542F\u5149\u6E90\u81EA\u5E26\u7684\u9634\u5F71","slug":"\u5982\u4F55\u5F00\u542F\u5149\u6E90\u81EA\u5E26\u7684\u9634\u5F71"},{"level":3,"title":"\u4F18\u5316\u9634\u5F71","slug":"\u4F18\u5316\u9634\u5F71"},{"level":2,"title":"\u5982\u4F55\u4F7F\u7528\u81EA\u5E26\u9634\u5F71\u7684\u56FE\u7247\u4F5C\u4E3A\u9634\u5F71","slug":"\u5982\u4F55\u4F7F\u7528\u81EA\u5E26\u9634\u5F71\u7684\u56FE\u7247\u4F5C\u4E3A\u9634\u5F71"},{"level":2,"title":"\u5982\u4F55\u9009\u62E9","slug":"\u5982\u4F55\u9009\u62E9"}],"relativePath":"MOOC/threejs-journey/02_Classic-techniques/Shadows.md"}',t={},e=p(`<h1 id="shadows" tabindex="-1">Shadows</h1><ul><li>\u9634\u5F71</li><li>\u8BFE\u7A0B\u4E2D\u8BB2\u7684\u751F\u6210\u9634\u5F71\u7684\u65B9\u6CD5 <ul><li>\u4F7F\u7528threejs\u706F\u5149\u81EA\u5E26\u7684\u9634\u5F71</li><li>\u4F7F\u7528\u5E26\u9634\u5F71\u7684\u56FE\u7247\u4F5C\u4E3A\u8D34\u56FE</li></ul></li><li>\u652F\u6301\u9634\u5F71\u7684\u706F\u5149 <ul><li>\u70B9\u5149\u6E90\uFF1A\u9634\u5F71\u76F8\u673A\u662F\u4E00\u4E2A\u900F\u89C6\u6444\u50CF\u673A</li><li>\u5E73\u884C\u5149\uFF1A\u9634\u5F71\u76F8\u673A\u662F\u4E00\u4E2A\u6B63\u4EA4\u6444\u50CF\u673A</li><li>\u805A\u5149\u706F\uFF1A\u9634\u5F71\u76F8\u673A\u662F\u4E00\u4E2A\u900F\u89C6\u6444\u50CF\u673A</li></ul></li></ul><h2 id="\u5982\u4F55\u5F00\u542F\u5149\u6E90\u81EA\u5E26\u7684\u9634\u5F71" tabindex="-1">\u5982\u4F55\u5F00\u542F\u5149\u6E90\u81EA\u5E26\u7684\u9634\u5F71</h2><ol><li><code>renderer.shadowMap.enabled = true</code></li><li><code>light.castShadow = true</code></li><li><code>mesh.castShadow = true</code></li><li><code>receivedShadowMesh.receiveShadow = true</code></li></ol><h3 id="\u4F18\u5316\u9634\u5F71" tabindex="-1">\u4F18\u5316\u9634\u5F71</h3><ul><li>mipmapping <ul><li><code>Light.shadow.mapSize.width = 1024;</code></li><li><code>Light.shadow.mapSize.height = 1024;</code></li></ul></li><li><code>Light.shadow.camera.near = 1;Light.shadow.camera.far = 6;</code></li><li>\u9634\u5F71\u7B97\u6CD5\uFF1A<code>renderer.shadowMap.type</code><ul><li>BasicShadowMap <ul><li>\u63D0\u4F9B\u672A\u7ECF\u8FC7\u6EE4\u7684\u9634\u5F71\u56FE</li><li><strong>\u6700\u5FEB\uFF0C\u4F46\u8D28\u91CF\u6700\u4F4E</strong>\u3002</li></ul></li><li>PCFShadowMap <ul><li>\u4F7F\u7528\u767E\u5206\u6BD4\u63A5\u8FD1\u8FC7\u6EE4\uFF08PCF\uFF09\u7B97\u6CD5\u8FC7\u6EE4\u9634\u5F71\u56FE</li><li>\u9ED8\u8BA4</li></ul></li><li>PCFSoftShadowMap <ul><li>\u4F7F\u7528\u767E\u5206\u6BD4\u63A5\u8FD1\u8FC7\u6EE4\uFF08PCF\uFF09\u7B97\u6CD5\u8FC7\u6EE4\u9634\u5F71\u56FE</li><li>\u662F\u5728\u4F7F\u7528\u4F4E\u5206\u8FA8\u7387\u7684\u9634\u5F71\u56FE\u65F6\uFF0C\u5177\u6709\u66F4\u597D\u7684\u8F6F\u9634\u5F71</li></ul></li><li>VSMShadowMap <ul><li>\u4F7F\u7528Variance Shadow Map\uFF08VSM\uFF09\u7B97\u6CD5\u8FC7\u6EE4\u9634\u5F71\u56FE</li><li>\u5F53\u4F7F\u7528VSMShadowMap\u65F6\uFF0C\u6240\u6709\u7684\u9634\u5F71\u63A5\u6536\u5668\u90FD\u4F1A\u4EA7\u751F\u9634\u5F71</li></ul></li></ul></li></ul><h2 id="\u5982\u4F55\u4F7F\u7528\u81EA\u5E26\u9634\u5F71\u7684\u56FE\u7247\u4F5C\u4E3A\u9634\u5F71" tabindex="-1">\u5982\u4F55\u4F7F\u7528\u81EA\u5E26\u9634\u5F71\u7684\u56FE\u7247\u4F5C\u4E3A\u9634\u5F71</h2><ul><li>baking shadow</li></ul><div class="language-js line-numbers-mode"><pre><code><span class="token keyword">const</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// \u52A0\u8F7D\u7EB9\u7406</span>
<span class="token keyword">const</span> textureLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>TextureLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bakedShadow <span class="token operator">=</span> textureLoader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&#39;...&#39;</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> canvas <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mesh <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>
	<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshStandardMaterial</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// \u4F7F\u7528\u7EB9\u7406\u4F5C\u4E3A\u9634\u5F71</span>
<span class="token keyword">const</span> meshShadow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>
	<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;#000&#39;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">transparent</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
		<span class="token literal-property property">alphaMap</span><span class="token operator">:</span> bakedShadow
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>mesh<span class="token punctuation">,</span> meshShadow<span class="token punctuation">)</span>

<span class="token keyword">const</span> clock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">animate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> elapsedTime <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">getElapsedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Update Objects</span>
	mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>elapsedTime<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
	mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>elapsedTime<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1.5</span><span class="token punctuation">;</span>
	mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>elapsedTime <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Update Shadow</span>
	meshShadow<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
	meshShadow<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z<span class="token punctuation">;</span>
	meshShadow<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>mesh<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0.3</span><span class="token punctuation">;</span>

	<span class="token comment">// render</span>
	renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>

	window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><h2 id="\u5982\u4F55\u9009\u62E9" tabindex="-1">\u5982\u4F55\u9009\u62E9</h2><ul><li>\u770B\u60C5\u51B5</li><li>\u5C3D\u53EF\u80FD\u5C11\u4F7F\u7528\u52A8\u6001\u9634\u5F71</li></ul>`,11),o=[e];function c(l,u,i,r,k,d){return a(),s("div",null,o)}var h=n(t,[["render",c]]);export{m as __pageData,h as default};
